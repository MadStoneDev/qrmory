# QRmory Caddyfile for Custom Domain Support
#
# This configuration:
# 1. Serves qrmory.com normally
# 2. Accepts any other domain and checks if it's registered
# 3. Auto-provisions SSL via Let's Encrypt for verified domains
#
# Replace YOUR_APP_HOST with your actual app container/host (e.g., localhost:3000 or qrmory-app:3000)

{
	# Global options
	email your-email@example.com  # For Let's Encrypt notifications

	# On-demand TLS - only provision certs for verified domains
	on_demand_tls {
		ask http://YOUR_APP_HOST/api/domains/check
		interval 2m
		burst 5
	}
}

# Main QRmory domain
qrmory.com, www.qrmory.com {
	reverse_proxy YOUR_APP_HOST
}

# Catch-all for custom domains
:443 {
	tls {
		on_demand
	}

	reverse_proxy YOUR_APP_HOST
}
